### 模块

Synapse 支持通过配置外部模块来扩展其功能。

注意：使用第三方模块时，您实际上允许他人运行自定义代码在您的 Synapse 服务器上。  
鼓励服务器管理员验证他们在其主服务器上使用的模块的来源，并确保这些模块在其实例上没有运行恶意代码。

#### 使用模块

要在 Synapse 上使用模块，请将其添加到配置文件的 `modules` 部分：

```
modules:
  - module: my_super_module.MySuperClass
    config:
      do_thing: true
  - module: my_other_super_module.SomeClass
    config: {}
```

每个模块由指向 Python 类的路径以及配置定义。给定模块的此信息应在模块自己的文档中提供。

#### 使用多个模块

本节中列出模块的顺序很重要。在处理可以由多个模块处理的操作时，Synapse 将始终优先考虑最先出现的模块（即在列表中最高的）。这意味着：

*   如果多个模块注册了相同的回调函数，则使用最先出现的模块注册的回调函数。
*   如果多个模块尝试为相同的 HTTP 路径注册处理程序，则只使用最先出现的模块注册的处理程序。其他模块注册的处理程序将被忽略，Synapse 会记录一个关于它们的警告消息。

请注意，Synapse 不允许通过密码认证提供者功能为同一登录类型使用不同字段的多个模块来实现认证检查器。如果发生这种情况，Synapse 将拒绝启动。

#### 当前状态

我们目前正在将模块接口迁移到这个系统中。虽然一些接口可能与之兼容，但其他接口仍需要在 Synapse 配置文件的另一部分进行配置。

目前，只有以下预先存在的接口与这个新系统兼容：

*   垃圾邮件检查器
*   第三方规则
*   存在路由器
*   密码认证提供者